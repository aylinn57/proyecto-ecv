<!DOCTYPE html>
<html lang="es">
<head>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1" />
    <title>Predicci√≥n de Enfermedad Cardiovascular (ECV)</title>
    <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0/dist/css/bootstrap.min.css" rel="stylesheet" />
</head>
<body class="bg-light">

    <!-- LOGO -->
    <div class="text-center my-4">
        <img src="/static/logo.png" alt="Aylinn - Masa" width="150">
    </div>

    <!-- TITULO -->
    <div class="container">
        <h1 class="text-center mb-4">Predicci√≥n de Enfermedad Cardiovascular (ECV)</h1>

        <!-- FORMULARIO -->
        <form onsubmit="event.preventDefault(); predecirECV();" class="row g-3">
            <div class="col-md-4">
                <label for="age" class="form-label">Edad:</label>
                <input type="number" class="form-control" id="age" required>
            </div>
            <div class="col-md-4">
                <label for="sex" class="form-label">Sexo (1=Hombre, 0=Mujer):</label>
                <input type="number" class="form-control" id="sex" required>
            </div>
            <div class="col-md-4">
                <label for="cp" class="form-label">Tipo de dolor en pecho (0-3):</label>
                <input type="number" class="form-control" id="cp" required>
            </div>
            <div class="col-md-4">
                <label for="trestbps" class="form-label">Presi√≥n en reposo:</label>
                <input type="number" class="form-control" id="trestbps" required>
            </div>
            <div class="col-md-4">
                <label for="chol" class="form-label">Colesterol:</label>
                <input type="number" class="form-control" id="chol" required>
            </div>
            <div class="col-md-4">
                <label for="fbs" class="form-label">FBS (>120) (1/0):</label>
                <input type="number" class="form-control" id="fbs" required>
            </div>
            <div class="col-md-4">
                <label for="restecg" class="form-label">ECG:</label>
                <input type="number" class="form-control" id="restecg" required>
            </div>
            <div class="col-md-4">
                <label for="thalach" class="form-label">M√°x ritmo card√≠aco:</label>
                <input type="number" class="form-control" id="thalach" required>
            </div>
            <div class="col-md-4">
                <label for="exang" class="form-label">Angina ejercicio (1/0):</label>
                <input type="number" class="form-control" id="exang" required>
            </div>
            <div class="col-md-4">
                <label for="oldpeak" class="form-label">Oldpeak:</label>
                <input type="number" step="0.1" class="form-control" id="oldpeak" required>
            </div>
            <div class="col-md-4">
                <label for="slope" class="form-label">Slope:</label>
                <input type="number" class="form-control" id="slope" required>
            </div>
            <div class="col-md-4">
                <label for="ca" class="form-label">CA:</label>
                <input type="number" class="form-control" id="ca" required>
            </div>
            <div class="col-md-4">
                <label for="thal" class="form-label">Thal:</label>
                <input type="number" class="form-control" id="thal" required>
            </div>

            <!-- BOT√ìN -->
            <div class="col-12 text-center mt-3">
                <button type="submit" class="btn btn-primary btn-lg">üîç Predecir ECV</button>
            </div>
        </form>

        <!-- RESULTADO -->
        <div id="resultado" class="mt-4 d-none"></div>

    </div>

     <!-- DESCRIPCI√ìN DE VARIABLES -->
        <div class="alert alert-info">
            <h4>üìã Descripci√≥n de las variables</h4>
            <ul>
                <li><strong>Edad:</strong> Edad del paciente</li>
                <li><strong>Sexo:</strong> G√©nero (1 = Hombre, 0 = Mujer)</li>
                <li><strong>Tipo de dolor en el pecho (cp):</strong> 0-3</li>
                <li><strong>Presi√≥n en reposo:</strong> Presi√≥n arterial en reposo (mm Hg)</li>
                <li><strong>Colesterol:</strong> Colesterol s√©rico (mg/dl)</li>
                <li><strong>FBS:</strong> Az√∫car en sangre en ayunas (>120 mg/dl) (1 = S√≠, 0 = No)</li>
                <li><strong>ECG:</strong> Resultados del ECG en reposo (0-2)</li>
                <li><strong>M√°x ritmo card√≠aco:</strong> Frecuencia card√≠aca m√°xima alcanzada</li>
                <li><strong>Angina ejercicio:</strong> Angina inducida por ejercicio (1 = S√≠, 0 = No)</li>
                <li><strong>Oldpeak:</strong> Depresi√≥n del ST inducida por el ejercicio</li>
                <li><strong>Slope:</strong> Pendiente del segmento ST durante el ejercicio</li>
                <li><strong>CA:</strong> N√∫mero de vasos principales coloreados (0-3)</li>
                <li><strong>Thal:</strong> Resultado de la prueba de talio (3, 6, 7)</li>
            </ul>
        </div>


    <!-- SCRIPT API -->
    <script>
        function predecirECV() {
            const paciente = {
                age: parseFloat(document.getElementById("age").value),
                sex: parseInt(document.getElementById("sex").value),
                cp: parseInt(document.getElementById("cp").value),
                trestbps: parseFloat(document.getElementById("trestbps").value),
                chol: parseFloat(document.getElementById("chol").value),
                fbs: parseInt(document.getElementById("fbs").value),
                restecg: parseInt(document.getElementById("restecg").value),
                thalach: parseFloat(document.getElementById("thalach").value),
                exang: parseInt(document.getElementById("exang").value),
                oldpeak: parseFloat(document.getElementById("oldpeak").value),
                slope: parseInt(document.getElementById("slope").value),
                ca: parseInt(document.getElementById("ca").value),
                thal: parseInt(document.getElementById("thal").value)
            };

            fetch("https://proyecto-ecv.onrender.com/predecir_ecv", {
                method: "POST",
                headers: { "Content-Type": "application/json" },
                body: JSON.stringify(paciente)
            })
            .then(response => response.json())
            .then(data => {
                console.log("Respuesta API:", data);
                const divResultado = document.getElementById("resultado");
                divResultado.innerHTML = `
                    <h4>Resultado: ${data.resultado}</h4>
                    <p><strong>Probabilidad de riesgo:</strong> ${data.probabilidad}</p>
                `;
                if (data.resultado.includes("Positivo")) {
                    divResultado.className = "alert alert-danger";
                } else {
                    divResultado.className = "alert alert-success";
                }
                divResultado.classList.remove("d-none");
            })
            .catch(error => {
                console.error("Error al llamar la API:", error);
                const divResultado = document.getElementById("resultado");
                divResultado.innerHTML = `<strong>‚ùå Error al llamar la API</strong>`;
                divResultado.className = "alert alert-warning";
                divResultado.classList.remove("d-none");
            });
        }
    </script>

</body>
</html>
